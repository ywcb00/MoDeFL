syntax = "proto3";

service ModelUpdate {
    rpc TransferModelUpdate(ModelWeights) returns (Ack) {}
    rpc EvaluateModel(ModelWeights) returns (EvaluationMetrics) {}
    rpc AllowTermination(NetworkID) returns (Ack) {}
};

message ModelWeights {
    repeated bytes layer_weights = 1;
    optional ModelGradient gradient = 2;
    string ip_and_port = 3;
};

message ModelGradient {
    repeated bytes gradient = 1;
}

message EvaluationMetrics {
    repeated Metric metrics = 1;
};

message Metric {
    string key = 1;
    float value = 2;
};

message NetworkID {
    string ip_and_port = 1;
};

message Ack {
    // empty message for ack purpose
};
